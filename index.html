<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×× ×ª×— ×©×™×—×•×ª AI | Chat Analyzer</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700;800&family=Rubik:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-card: rgba(255, 255, 255, 0.03);
            --border-color: rgba(255, 255, 255, 0.08);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.6);
            --accent-cyan: #00d4ff;
            --accent-purple: #a855f7;
            --accent-pink: #ec4899;
            --accent-green: #10b981;
            --gradient-main: linear-gradient(135deg, #00d4ff 0%, #a855f7 50%, #ec4899 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Heebo', 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        /* Animated background */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }

        .bg-animation::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at 30% 30%, rgba(0, 212, 255, 0.08) 0%, transparent 50%),
                        radial-gradient(circle at 70% 70%, rgba(168, 85, 247, 0.08) 0%, transparent 50%),
                        radial-gradient(circle at 50% 50%, rgba(236, 72, 153, 0.05) 0%, transparent 50%);
            animation: bgFloat 20s ease-in-out infinite;
        }

        @keyframes bgFloat {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(2%, 2%) rotate(1deg); }
            66% { transform: translate(-2%, 1%) rotate(-1deg); }
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Header */
        header {
            text-align: center;
            padding: 50px 20px 40px;
            position: relative;
        }

        .logo {
            display: inline-flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .logo-icon {
            width: 60px;
            height: 60px;
            background: var(--gradient-main);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            box-shadow: 0 10px 40px rgba(0, 212, 255, 0.3);
        }

        h1 {
            font-family: 'Rubik', sans-serif;
            font-size: 3rem;
            font-weight: 700;
            background: var(--gradient-main);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -1px;
        }

        .tagline {
            color: var(--text-secondary);
            font-size: 1.15rem;
            max-width: 600px;
            margin: 0 auto;
            font-weight: 300;
        }

        /* API Key Setup */
        .api-setup {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
        }

        .api-setup.hidden {
            display: none;
        }

        .api-setup h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .api-input-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .api-input-group input {
            flex: 1;
            min-width: 250px;
            padding: 14px 18px;
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: 'Consolas', monospace;
            transition: all 0.3s ease;
        }

        .api-input-group input:focus {
            outline: none;
            border-color: var(--accent-cyan);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.2);
        }

        .api-input-group input::placeholder {
            color: var(--text-secondary);
        }

        .api-status {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 12px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .api-status.connected {
            color: var(--accent-green);
        }

        .api-status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--text-secondary);
        }

        .api-status.connected .api-status-dot {
            background: var(--accent-green);
            box-shadow: 0 0 10px var(--accent-green);
        }

        .api-info {
            margin-top: 15px;
            padding: 12px 15px;
            background: rgba(168, 85, 247, 0.1);
            border: 1px solid rgba(168, 85, 247, 0.2);
            border-radius: 8px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .api-info a {
            color: var(--accent-purple);
            text-decoration: none;
        }

        .api-info a:hover {
            text-decoration: underline;
        }

        /* Main Grid */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 1000px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Panels */
        .panel {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 28px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .panel:hover {
            border-color: rgba(255, 255, 255, 0.12);
        }

        .panel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .panel-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .panel-title .icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-main);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        /* Textarea */
        .textarea-wrapper {
            position: relative;
        }

        textarea {
            width: 100%;
            height: 380px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid var(--border-color);
            border-radius: 14px;
            padding: 18px;
            color: var(--text-primary);
            font-family: 'Heebo', sans-serif;
            font-size: 0.95rem;
            resize: vertical;
            transition: all 0.3s ease;
            line-height: 1.7;
        }

        textarea:focus {
            outline: none;
            border-color: var(--accent-cyan);
            box-shadow: 0 0 30px rgba(0, 212, 255, 0.15);
        }

        textarea::placeholder {
            color: var(--text-secondary);
            opacity: 0.7;
        }

        /* Buttons */
        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            flex: 1;
            min-width: 140px;
            padding: 16px 24px;
            border: none;
            border-radius: 12px;
            font-family: 'Heebo', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary {
            background: var(--gradient-main);
            color: #000;
            box-shadow: 0 5px 25px rgba(0, 212, 255, 0.3);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(0, 212, 255, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Sample Buttons */
        .samples {
            margin-top: 20px;
        }

        .samples-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .samples-grid {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .sample-btn {
            padding: 10px 16px;
            background: rgba(168, 85, 247, 0.15);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Heebo', sans-serif;
        }

        .sample-btn:hover {
            background: rgba(168, 85, 247, 0.25);
            border-color: rgba(168, 85, 247, 0.5);
            transform: translateY(-1px);
        }

        /* Results */
        .results-container {
            min-height: 500px;
        }

        .placeholder {
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 60px 30px;
            color: var(--text-secondary);
        }

        .placeholder-icon {
            font-size: 5rem;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .placeholder-text {
            font-size: 1.1rem;
            max-width: 300px;
        }

        /* Loading */
        .loading {
            display: none;
            text-align: center;
            padding: 80px 30px;
        }

        .loading.active {
            display: block;
        }

        .loader {
            width: 70px;
            height: 70px;
            position: relative;
            margin: 0 auto 30px;
        }

        .loader::before,
        .loader::after {
            content: '';
            position: absolute;
            border-radius: 50%;
        }

        .loader::before {
            width: 100%;
            height: 100%;
            border: 3px solid transparent;
            border-top-color: var(--accent-cyan);
            border-right-color: var(--accent-purple);
            animation: spin 1s linear infinite;
        }

        .loader::after {
            width: 60%;
            height: 60%;
            top: 20%;
            left: 20%;
            border: 3px solid transparent;
            border-bottom-color: var(--accent-pink);
            border-left-color: var(--accent-cyan);
            animation: spin 0.8s linear infinite reverse;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.2rem;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .loading-step {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Stats Bar */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 18px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            background: var(--gradient-main);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Result Sections */
        .results {
            display: none;
        }

        .results.active {
            display: block;
            animation: fadeUp 0.5s ease;
        }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-section {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 16px;
            padding: 22px;
            margin-bottom: 20px;
            border-right: 4px solid;
            position: relative;
            transition: all 0.3s ease;
        }

        .result-section:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        .result-section.summary {
            border-color: var(--accent-cyan);
        }

        .result-section.opinions {
            border-color: var(--accent-purple);
        }

        .result-section.ai-opinion {
            border-color: var(--accent-pink);
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .result-header .icon {
            font-size: 1.3rem;
        }

        .result-content {
            color: var(--text-secondary);
            line-height: 1.9;
            font-size: 0.95rem;
        }

        .result-content strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        .copy-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 0.75rem;
            cursor: pointer;
            opacity: 0;
            transition: all 0.3s ease;
            font-family: 'Heebo', sans-serif;
        }

        .result-section:hover .copy-btn {
            opacity: 1;
        }

        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }

        /* Error */
        .error-msg {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 10px;
            padding: 15px 18px;
            margin-bottom: 20px;
            display: none;
            color: #fca5a5;
            font-size: 0.9rem;
        }

        .error-msg.active {
            display: block;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        footer a {
            color: var(--accent-cyan);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* Mobile */
        @media (max-width: 600px) {
            h1 {
                font-size: 2rem;
            }

            .panel {
                padding: 20px;
            }

            textarea {
                height: 300px;
            }

            .stats-bar {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">ğŸ’¬</div>
            </div>
            <h1>×× ×ª×— ×©×™×—×•×ª AI</h1>
            <p class="tagline">×”×¢×œ×” ×©×™×—×” ××•×•××˜×¡××¤ ××• ×›×œ ××§×•×¨ ××—×¨ ×•×§×‘×œ × ×™×ª×•×— ××¢××™×§ ×¢× ×‘×™× ×” ××œ××›×•×ª×™×ª</p>
        </header>

        <!-- API Key Setup -->
        <div class="api-setup" id="api-setup">
            <h3>ğŸ”‘ ×”×’×“×¨×ª API Key</h3>
            <div class="api-input-group">
                <input type="password" id="api-key-input" placeholder="×”×›× ×¡ ××ª ×”-Anthropic API Key ×©×œ×š...">
                <button class="btn btn-primary" onclick="saveApiKey()" style="flex: 0; min-width: auto; padding: 14px 25px;">
                    ×©××•×¨
                </button>
            </div>
            <div class="api-status" id="api-status">
                <span class="api-status-dot"></span>
                <span>×œ× ××—×•×‘×¨</span>
            </div>
            <div class="api-info">
                ğŸ”‘ ×™×© ×œ×š ×›×‘×¨ ×—×©×‘×•×Ÿ? <a href="https://console.anthropic.com/settings/keys" target="_blank">×œ×—×¥ ×›××Ÿ ×œ×§×‘×œ×ª ×”-API Key ×©×œ×š</a>
                <br><br>
                ğŸ’¡ ××™×Ÿ ×œ×š API Key? <a href="https://console.anthropic.com/" target="_blank">×¦×•×¨ ×—×©×‘×•×Ÿ ×‘-Anthropic</a> ×•×§×‘×œ ××¤×ª×— ×‘×—×™× ×.
                ×”××¤×ª×— × ×©××¨ ×¨×§ ×‘×“×¤×“×¤×Ÿ ×©×œ×š ×•×œ× × ×©×œ×— ×œ×©×•× ××§×•× ××—×¨.
            </div>
        </div>

        <div class="main-grid">
            <!-- Input Panel -->
            <div class="panel">
                <div class="panel-header">
                    <h2 class="panel-title">
                        <span class="icon">ğŸ“</span>
                        ×”×“×‘×§ ××ª ×”×©×™×—×”
                    </h2>
                </div>

                <div class="textarea-wrapper">
                    <textarea id="chat-input" placeholder="×”×“×‘×§ ×›××Ÿ ××ª ×”×©×™×—×”...

×¤×•×¨××˜ ×•×•××˜×¡××¤:
[28.1.2025, 10:30] ×™×•×¡×™: ××” ×“×¢×ª×›×?
[28.1.2025, 10:31] ×“× ×™: ×× ×™ ×—×•×©×‘ ×©...

××• ×¤×•×¨××˜ ×¤×©×•×˜:
×™×•×¡×™: ×‘×œ×” ×‘×œ×”
×“× ×™: ×‘×œ×” ×‘×œ×”"></textarea>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" id="analyze-btn" onclick="analyzeChat()">
                        ğŸš€ × ×ª×— ××ª ×”×©×™×—×”
                    </button>
                    <button class="btn btn-secondary" onclick="clearAll()">
                        ğŸ—‘ï¸ × ×§×”
                    </button>
                </div>

                <div class="samples">
                    <div class="samples-label">ğŸ’¡ ×©×™×—×•×ª ×œ×“×•×’××”:</div>
                    <div class="samples-grid">
                        <button class="sample-btn" onclick="loadSample('politics')">ğŸ—³ï¸ ×¤×•×œ×™×˜×™×§×”</button>
                        <button class="sample-btn" onclick="loadSample('tech')">ğŸ’» ×˜×›× ×•×œ×•×’×™×”</button>
                        <button class="sample-btn" onclick="loadSample('sports')">âš½ ×¡×¤×•×¨×˜</button>
                        <button class="sample-btn" onclick="loadSample('family')">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ××©×¤×—×”</button>
                    </div>
                </div>
            </div>

            <!-- Results Panel -->
            <div class="panel">
                <div class="panel-header">
                    <h2 class="panel-title">
                        <span class="icon">ğŸ“Š</span>
                        ×ª×•×¦××•×ª ×”× ×™×ª×•×—
                    </h2>
                </div>

                <div class="results-container">
                    <div class="error-msg" id="error-msg"></div>

                    <div class="loading" id="loading">
                        <div class="loader"></div>
                        <div class="loading-text">×× ×ª×— ××ª ×”×©×™×—×”...</div>
                        <div class="loading-step" id="loading-step">×§×•×¨× ××ª ×”×”×•×“×¢×•×ª...</div>
                    </div>

                    <div class="results" id="results">
                        <div class="stats-bar">
                            <div class="stat-card">
                                <div class="stat-value" id="msg-count">0</div>
                                <div class="stat-label">×”×•×“×¢×•×ª</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="participant-count">0</div>
                                <div class="stat-label">××©×ª×ª×¤×™×</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="word-count">0</div>
                                <div class="stat-label">××™×œ×™×</div>
                            </div>
                        </div>

                        <div class="result-section summary">
                            <button class="copy-btn" onclick="copySection('summary-content')">ğŸ“‹ ×”×¢×ª×§</button>
                            <div class="result-header">
                                <span class="icon">ğŸ“‹</span>
                                ×ª×§×¦×™×¨ ×”×©×™×—×”
                            </div>
                            <div class="result-content" id="summary-content"></div>
                        </div>

                        <div class="result-section opinions">
                            <button class="copy-btn" onclick="copySection('opinions-content')">ğŸ“‹ ×”×¢×ª×§</button>
                            <div class="result-header">
                                <span class="icon">ğŸ‘¥</span>
                                ×“×¢×•×ª ×”××©×ª×ª×¤×™×
                            </div>
                            <div class="result-content" id="opinions-content"></div>
                        </div>

                        <div class="result-section ai-opinion">
                            <button class="copy-btn" onclick="copySection('ai-opinion-content')">ğŸ“‹ ×”×¢×ª×§</button>
                            <div class="result-header">
                                <span class="icon">ğŸ¤–</span>
                                ×“×¢×ª ×”-AI
                            </div>
                            <div class="result-content" id="ai-opinion-content"></div>
                        </div>
                    </div>

                    <div class="placeholder" id="placeholder">
                        <div class="placeholder-icon">ğŸ’¬</div>
                        <div class="placeholder-text">×”×“×‘×§ ×©×™×—×” ×•×œ×—×¥ "× ×ª×— ××ª ×”×©×™×—×”" ×›×“×™ ×œ×§×‘×œ × ×™×ª×•×— ××¢××™×§</div>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            × ×‘× ×” ×¢× â¤ï¸ ×•-Claude AI | 
            <a href="https://github.com/roysadeh520" target="_blank">GitHub</a>
        </footer>
    </div>

    <script>
        // Sample chats
        const sampleChats = {
            politics: `[28.1.2025, 09:15] ××‘×™: ×¨××™×ª× ××ª ×”×”×—×œ×˜×” ×”×—×“×©×” ×©×œ ×”×××©×œ×”?
[28.1.2025, 09:16] ×“× ×”: ×›×Ÿ, ×× ×™ ×—×•×©×‘×ª ×©×–×” ×¦×¢×“ ×—×™×•×‘×™. ×¡×•×£ ×¡×•×£ ×¢×•×©×™× ××©×”×•
[28.1.2025, 09:17] ×™×•×¡×™: ×œ× ××¡×›×™× ×‘×›×œ×œ. ×–×” ×¨×§ ×™×¤×’×¢ ×‘××¢××“ ×”×‘×™× ×™×™×
[28.1.2025, 09:18] ××™×›×œ: ×¦×¨×™×š ×œ×—×›×•×ª ×•×œ×¨××•×ª ××ª ×”×ª×•×¦××•×ª ×‘×¤×•×¢×œ
[28.1.2025, 09:19] ××‘×™: ×™×•×¡×™, ×œ××” ××ª×” ×ª××™×“ ×›×œ ×›×š ×©×œ×™×œ×™?
[28.1.2025, 09:20] ×™×•×¡×™: ×× ×™ ×œ× ×©×œ×™×œ×™, ×× ×™ ×¨×™××œ×™×¡×˜. ×ª×¡×ª×›×œ ×¢×œ ×”× ×ª×•× ×™×
[28.1.2025, 09:21] ×“× ×”: ×”× ×ª×•× ×™× ××¨××™× ×©×”×¨×¤×•×¨××” ×”×§×•×“××ª ×¢×‘×“×”
[28.1.2025, 09:22] ××™×›×œ: ×™×© ×˜×™×¢×•× ×™× ×˜×•×‘×™× ×œ×©× ×™ ×”×¦×“×“×™×. ×× ×™ ××¢×“×™×¤×” ×œ× ×œ×§×¤×•×¥ ×œ××¡×§× ×•×ª
[28.1.2025, 09:23] ×™×•×¡×™: ×“× ×”, ××™×–×” × ×ª×•× ×™×? ×ª×¨××™ ×œ×™ ××§×•×¨
[28.1.2025, 09:24] ×“× ×”: ×§×¨××ª×™ ××ª ×–×” ×‘×›×œ×›×œ×™×¡×˜ ×©×œ×©×•×
[28.1.2025, 09:25] ××‘×™: ×‘×›×œ ××§×¨×”, ×× ×™ ×ª×•××š ×‘×–×”. ×¦×¨×™×š ×œ×ª×ª ×¦'×× ×¡`,
            
            tech: `[28.1.2025, 14:00] ×¨×•×Ÿ: ××” ×“×¢×ª×›× ×¢×œ Claude ×œ×¢×•××ª ChatGPT?
[28.1.2025, 14:01] ×©×™×¨×”: Claude ×™×•×ª×¨ ×˜×•×‘ ×‘×›×ª×™×‘×” ×•×”×‘× ×”, ×œ×“×¢×ª×™
[28.1.2025, 14:02] ×¢×•××¨: ChatGPT ×™×© ×œ×• ×™×•×ª×¨ ×¤×™×¦'×¨×™× ×›××• ×ª××•× ×•×ª ×•×›×•'
[28.1.2025, 14:03] ×¨×•×Ÿ: ×× ×™ ××©×ª××© ×‘×©× ×™×”×, ×ª×œ×•×™ ×‘××©×™××”
[28.1.2025, 14:04] × ×•×¢×”: Claude × ×¨××” ×œ×™ ×™×•×ª×¨ "×× ×•×©×™" ×‘×ª×©×•×‘×•×ª
[28.1.2025, 14:05] ×©×™×¨×”: ×‘×“×™×•×§! ×•×’× ×™×•×ª×¨ ×–×”×™×¨ ×¢× ××™×“×¢ ×œ× × ×›×•×Ÿ
[28.1.2025, 14:06] ×¢×•××¨: ××‘×œ ×œ×¤×¢××™× ×”×•× ××¡×¨×‘ ×œ×“×‘×¨×™× ×‘×œ×™ ×¡×™×‘×”
[28.1.2025, 14:07] ×¨×•×Ÿ: × ×›×•×Ÿ, ×™×© ×œ×• ×™×•×ª×¨ ××’×‘×œ×•×ª
[28.1.2025, 14:08] × ×•×¢×”: ×× ×™ ××¢×“×™×¤×” AI ×©××¡×¨×‘ ×××©×¨ ××—×“ ×©×××¦×™× ×“×‘×¨×™×
[28.1.2025, 14:09] ×¢×•××¨: ×¤×•×™× ×˜. ×‘×¡×•×£ ×©× ×™×”× ××“×”×™××™×
[28.1.2025, 14:10] ×©×™×¨×”: ××¡×›×™××”, ×”×¢×ª×™×“ ×¤×” ğŸš€`,
            
            sports: `[28.1.2025, 21:30] ×’×™×œ: ××™×–×” ××©×—×§ ×”×™×” ×”×¢×¨×‘!
[28.1.2025, 21:31] ×ª×•××¨: ×œ×™×‘×¨×¤×•×œ ×©×•×œ×˜×™× ×”×¢×•× ×”, ××™×Ÿ ××” ×œ×¢×©×•×ª
[28.1.2025, 21:32] ××•×¨: ×¡××œ×— ×¤×©×•×˜ ×—×™×™×–×¨. ×”×’×•×œ ×”×©× ×™ ×©×œ×• ×”×™×” ××˜×•×¨×£
[28.1.2025, 21:33] ×××•×¨: ×¦'×œ×¡×™ ×”×™×• ×¦×¨×™×›×™× ×œ× ×¦×—, ×¤×¡×¤×¡×• ×”××•×Ÿ ×”×–×“×× ×•×™×•×ª
[28.1.2025, 21:34] ×’×™×œ: ×××•×¨, ××ª×” ×ª××™×“ ××•×¦× ×ª×™×¨×•×¦×™× ğŸ˜‚
[28.1.2025, 21:35] ×ª×•××¨: ×”×××ª ×©×”×©×•×¤×˜ ×”×™×” × ×’×“× ×§×¦×ª
[28.1.2025, 21:36] ××•×¨: ×‘×•××•, ×œ×™×‘×¨×¤×•×œ ×”×™×• ×¤×©×•×˜ ×™×•×ª×¨ ×˜×•×‘×™×
[28.1.2025, 21:37] ×××•×¨: ××•×§×™×™ × ×›×•×Ÿ, ××‘×œ ×”×¤×¢×¨ ×œ× ×›×–×” ×’×“×•×œ ×›××• ×©×”×ª×•×¦××” ××¨××”
[28.1.2025, 21:38] ×’×™×œ: ×¡×œ×•×˜ ×¢×•×©×” ×¢×‘×•×“×” ××˜×•×¨×¤×ª. ××™ ×”×™×” ××××™×Ÿ ××—×¨×™ ×§×œ×•×¤?
[28.1.2025, 21:39] ×ª×•××¨: ×”×©× ×” ×–×” ×©×œ×”×, ×œ× ×¨×•××” ××™ ×™×¢×¦×•×¨ ××•×ª×
[28.1.2025, 21:40] ××•×¨: ××¨×¡× ×œ ×¢×“×™×™×Ÿ ×‘×ª××•× ×”!`,

            family: `[28.1.2025, 18:00] ×××: ×™×œ×“×™×, ××” ×¢×•×©×™× ×‘×©×‘×ª?
[28.1.2025, 18:01] ×™×¢×œ: ×× ×™ ×—×•×©×‘×ª ×©×›×“××™ ×œ×œ×›×ª ×œ×™×, ××–×’ ×”××•×•×™×¨ ××•×©×œ×
[28.1.2025, 18:02] ×“× ×™: ×™×? ×‘×™× ×•××¨? ××ª ×¨×¦×™× ×™×ª?
[28.1.2025, 18:03] ××‘×: ×× ×™ ××¦×‘×™×¢ ×œ×˜×™×•×œ ×‘×¦×¤×•×Ÿ. ×™×© ×¤×¨×™×—×” ×¢×›×©×™×•
[28.1.2025, 18:04] ×™×¢×œ: ××‘×, × ×¡×¢× ×• ×œ×¦×¤×•×Ÿ ×œ×¤× ×™ ×©×‘×•×¢×™×™×...
[28.1.2025, 18:05] ×××: ××•×œ×™ ×¡×ª× ××¨×•×—×” ××©×¤×—×ª×™×ª ×‘×‘×™×ª?
[28.1.2025, 18:06] ×“× ×™: +1 ×œ×××. ×¢×™×™×¤×™× ××˜×™×•×œ×™×
[28.1.2025, 18:07] ×™×¢×œ: ××©×¢××! ×× ×—× ×• ×ª××™×“ ×‘×‘×™×ª
[28.1.2025, 18:08] ××‘×: ×™×¢×œ, ×œ×¤×¢××™× ×˜×•×‘ ×œ×”×™×•×ª ×‘×™×—×“ ×‘×œ×™ ×œ×¨×•×¥
[28.1.2025, 18:09] ×××: ×‘×“×™×•×§. ×× ×™ ××›×™×Ÿ ××ª ×”×œ×–× ×™×” ×”××™×•×—×“×ª ×©×œ×™
[28.1.2025, 18:10] ×™×¢×œ: ××•×§×™×™ ×× ×™×© ×œ×–× ×™×” ×× ×™ ×‘×¢×“ ğŸ˜‹
[28.1.2025, 18:11] ×“× ×™: ×”×! ×™×“×¢×ª×™ ×©×”×œ×–× ×™×” ×ª×©×›× ×¢ ××•×ª×”`
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            const savedKey = localStorage.getItem('anthropic_api_key');
            if (savedKey) {
                document.getElementById('api-key-input').value = savedKey;
                updateApiStatus(true);
            }
        });

        function saveApiKey() {
            const key = document.getElementById('api-key-input').value.trim();
            if (key) {
                localStorage.setItem('anthropic_api_key', key);
                updateApiStatus(true);
            }
        }

        function updateApiStatus(connected) {
            const status = document.getElementById('api-status');
            if (connected) {
                status.classList.add('connected');
                status.innerHTML = '<span class="api-status-dot"></span><span>××—×•×‘×¨ âœ“</span>';
            } else {
                status.classList.remove('connected');
                status.innerHTML = '<span class="api-status-dot"></span><span>×œ× ××—×•×‘×¨</span>';
            }
        }

        function loadSample(type) {
            document.getElementById('chat-input').value = sampleChats[type];
        }

        function clearAll() {
            document.getElementById('chat-input').value = '';
            document.getElementById('results').classList.remove('active');
            document.getElementById('placeholder').style.display = 'flex';
            document.getElementById('error-msg').classList.remove('active');
        }

        function showError(message) {
            const el = document.getElementById('error-msg');
            el.textContent = 'âŒ ' + message;
            el.classList.add('active');
        }

        function hideError() {
            document.getElementById('error-msg').classList.remove('active');
        }

        function setLoading(isLoading, step = '') {
            const loading = document.getElementById('loading');
            const placeholder = document.getElementById('placeholder');
            const results = document.getElementById('results');
            const btn = document.getElementById('analyze-btn');

            if (isLoading) {
                loading.classList.add('active');
                placeholder.style.display = 'none';
                results.classList.remove('active');
                btn.disabled = true;
                if (step) document.getElementById('loading-step').textContent = step;
            } else {
                loading.classList.remove('active');
                btn.disabled = false;
            }
        }

        function parseChat(text) {
            const lines = text.trim().split('\n').filter(l => l.trim());
            const messages = [];
            const participants = new Set();
            
            const patterns = [
                /^\[[\d.\/]+,?\s*[\d:]+\]\s*([^:]+):\s*(.+)$/,
                /^([^:]+):\s*(.+)$/,
                /^([^,]+),\s*\[.+\]\s*(.+)$/
            ];

            for (const line of lines) {
                for (const pattern of patterns) {
                    const match = line.match(pattern);
                    if (match) {
                        const name = match[1].trim();
                        const message = match[2].trim();
                        if (name && message && name.length < 30) {
                            messages.push({ name, message });
                            participants.add(name);
                        }
                        break;
                    }
                }
            }

            return {
                messages,
                participants: Array.from(participants),
                wordCount: text.split(/\s+/).length
            };
        }

        async function analyzeChat() {
            hideError();
            
            const apiKey = localStorage.getItem('anthropic_api_key');
            if (!apiKey) {
                showError('× × ×œ×”×–×™×Ÿ API Key ×§×•×“×');
                return;
            }

            const chatText = document.getElementById('chat-input').value.trim();
            if (!chatText) {
                showError('× × ×œ×”×“×‘×™×§ ×©×™×—×” ×œ× ×™×ª×•×—');
                return;
            }

            const parsed = parseChat(chatText);
            if (parsed.messages.length < 2) {
                showError('×œ× ×–×•×”×• ××¡×¤×™×§ ×”×•×“×¢×•×ª. ×•×•×“× ×©×”×¤×•×¨××˜ × ×›×•×Ÿ (×©×: ×”×•×“×¢×”)');
                return;
            }

            setLoading(true, '××¢×‘×“ ××ª ×”×”×•×“×¢×•×ª...');

            // Update stats
            document.getElementById('msg-count').textContent = parsed.messages.length;
            document.getElementById('participant-count').textContent = parsed.participants.length;
            document.getElementById('word-count').textContent = parsed.wordCount;

            try {
                setLoading(true, '×©×•×œ×— ×œ-Claude ×œ× ×™×ª×•×—...');

                const response = await fetch('https://api.anthropic.com/v1/messages', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-api-key': apiKey,
                        'anthropic-version': '2023-06-01',
                        'anthropic-dangerous-direct-browser-access': 'true'
                    },
                    body: JSON.stringify({
                        model: 'claude-sonnet-4-20250514',
                        max_tokens: 2000,
                        messages: [{
                            role: 'user',
                            content: `××ª×” ×× ×ª×— ×©×™×—×•×ª ××§×¦×•×¢×™. × ×ª×— ××ª ×”×©×™×—×” ×”×‘××” ×•×¡×¤×§:

1. **×ª×§×¦×™×¨ ×”×©×™×—×”** (3-5 ××©×¤×˜×™×): ××” ×”× ×•×©× ×”××¨×›×–×™? ××” ×§×¨×” ×‘×©×™×—×”?

2. **×“×¢×•×ª ×”××©×ª×ª×¤×™×**: ×œ×›×œ ××©×ª×ª×£, ×ª××¨ ×‘×§×¦×¨×” ××ª ×¢××“×ª×•/×“×¢×ª×• ×‘×©×™×—×”. ×¤×•×¨××˜:
**[×©×]**: [×“×¢×ª×• ×‘×§×¦×¨×”]

3. **×“×¢×ª ×”-AI**: ×ª×Ÿ ××ª ×“×¢×ª×š ×¢×œ ×”× ×•×©× ×©× ×“×•×Ÿ (×× ××¤×©×¨), ××• ×”×¢×¨×•×ª ×¢×œ ×“×™× ××™×§×ª ×”×©×™×—×”, × ×§×•×“×•×ª ××¢× ×™×™× ×•×ª, ××• ×ª×•×‘× ×•×ª. ×× ×”× ×•×©× ×©× ×•×™ ×‘××—×œ×•×§×ª, ×”×¦×’ ××ª ×”×¦×“×“×™× ×‘×¦×•×¨×” ×××•×–× ×ª.

×”×©×™×—×”:
${chatText}

×¢× ×” ×‘×¢×‘×¨×™×ª. ×”×©×ª××© ×‘×¤×•×¨××˜ ×‘×¨×•×¨ ×¢× ×›×•×ª×¨×•×ª.`
                        }]
                    })
                });

                if (!response.ok) {
                    const err = await response.json();
                    throw new Error(err.error?.message || '×©×’×™××” ×‘×§×¨×™××” ×œ-API');
                }

                const data = await response.json();
                const analysis = data.content[0].text;

                setLoading(true, '××¢×‘×“ ××ª ×”×ª×•×¦××•×ª...');
                displayResults(analysis);

            } catch (error) {
                console.error('Error:', error);
                showError(error.message || '×©×’×™××” ×‘× ×™×ª×•×—. ×‘×“×•×§ ××ª ×”-API Key');
                setLoading(false);
            }
        }

        function displayResults(analysis) {
            let summary = '';
            let opinions = '';
            let aiOpinion = '';

            // Parse sections
            const parts = analysis.split(/(?=\*\*\d\.|#{1,3}|\*\*×ª×§×¦×™×¨|\*\*×“×¢×•×ª|\*\*×“×¢×ª)/);
            
            for (const part of parts) {
                const lower = part.toLowerCase();
                if (lower.includes('×ª×§×¦×™×¨')) {
                    summary = part.replace(/^\*\*\d\.\s*\*\*|\*\*×ª×§×¦×™×¨[^*]*\*\*:?|#{1,3}[^#\n]*:?/gi, '').trim();
                } else if (lower.includes('×“×¢×•×ª ×”××©×ª×ª×¤×™×') || (lower.includes('×“×¢×•×ª') && !lower.includes('×“×¢×ª ×”'))) {
                    opinions = part.replace(/^\*\*\d\.\s*\*\*|\*\*×“×¢×•×ª[^*]*\*\*:?|#{1,3}[^#\n]*:?/gi, '').trim();
                } else if (lower.includes('×“×¢×ª ×”')) {
                    aiOpinion = part.replace(/^\*\*\d\.\s*\*\*|\*\*×“×¢×ª[^*]*\*\*:?|#{1,3}[^#\n]*:?/gi, '').trim();
                }
            }

            // Fallback
            if (!summary && !opinions && !aiOpinion) {
                summary = analysis;
            }

            document.getElementById('summary-content').innerHTML = formatText(summary || '×œ× × ××¦× ×ª×§×¦×™×¨');
            document.getElementById('opinions-content').innerHTML = formatText(opinions || '×œ× × ××¦××• ×“×¢×•×ª');
            document.getElementById('ai-opinion-content').innerHTML = formatText(aiOpinion || '××™×Ÿ ×“×¢×” ×–××™× ×”');

            setLoading(false);
            document.getElementById('results').classList.add('active');
            document.getElementById('placeholder').style.display = 'none';
        }

        function formatText(text) {
            return text
                .replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>')
                .replace(/\*([^*]+)\*/g, '<em>$1</em>')
                .replace(/\n\n/g, '<br><br>')
                .replace(/\n/g, '<br>');
        }

        function copySection(elementId) {
            const el = document.getElementById(elementId);
            navigator.clipboard.writeText(el.innerText).then(() => {
                const btn = el.parentElement.querySelector('.copy-btn');
                const original = btn.textContent;
                btn.textContent = 'âœ… ×”×•×¢×ª×§!';
                setTimeout(() => btn.textContent = original, 2000);
            });
        }
    </script>
</body>
</html>
